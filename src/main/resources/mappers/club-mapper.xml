<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="clubMapper">
	 
	
	<select id="getListCount" resultType="_int">
		select count(*)
		from tb_club
			join tb_board using(board_no)
		where board_delete = 'N'
	</select>
	
	<select id="selectList" resultMap="clubResultSet">
		select club_name, board_no, club_intro, club_plan, club_place, club_etc, max_people, end_yn, file_name
		from tb_club
			join tb_board using(board_no)
            left join tb_file using(board_no) 
		where board_delete = 'N'
		order by board_no desc
	</select>
	
	<resultMap type="Club" id="clubResultSet">
		<id property="clubName" column="CLUB_NAME"/>
		<result property="boardNo" column="BOARD_NO"/>
		<result property="clubIntro" column="CLUB_INTRO"/>
		<result property="clubPlan" column="CLUB_PLAN"/>
		<result property="clubPlace" column="CLUB_PLACE"/>
		<result property="clubEtc" column="CLUB_ETC"/>
		<result property="maxPeople" column="MAX_PEOPLE"/>
		<result property="endYn" column="END_YN"/>
		<result property="fileName" column="FILE_NAME"/>
	</resultMap>
	
	<select id="selectClub" resultMap="clubResultSet">
		select club_name, board_no, club_intro, club_plan, club_place, club_etc, max_people, end_yn, file_name
		from tb_club
			join tb_board using(board_no)
            left join tb_file using(board_no)
        where board_delete = 'N' and club_name = '${ clubName }'
	</select>
	
	
	<insert id="insertBoard">
		insert into tb_board
		values(SEQ_BOARD.NEXTVAL, '동호회', '동호회', sysdate, '이름수정예정', default, default)
	</insert>
	
	<insert id="insertClub">
		insert into tb_club
		values(#{clubName}, SEQ_BOARD.CURRVAL, #{clubIntro}, #{clubPlan}, #{clubPlace}, #{clubEtc}, #{maxPeople}, default)
	</insert>
	
	<insert id="insertClubMember">
		insert into tb_club_join
		values(#{clubName}, #{user})
	</insert>
	
	<insert id="insertFile">
		insert into tb_file
		values(SEQ_FILE.NEXTVAL, SEQ_BOARD.CURRVAL, #{renameFileName}, NULL, NULL)
	</insert>
	
	<update id="deleteClub">
		update tb_board
		set BOARD_DELETE = 'Y'
		where BOARD_NO = 4
	</update>
	
</mapper>
